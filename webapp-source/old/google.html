<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>Google Maps API Example - Geocoding API</title>
    <script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAAiflk3RC59GlSewXxvZDrIhSKjjOOwOf6Deakv_c0W5fk5OntFRTpe1ELMDcNTMf2mODmqKh0DXLlcw"
      type="text/javascript"></script>
    <script type="text/javascript">
    //<![CDATA[

    var map = null;
    var geocoder = null;

    function load() {
      if (GBrowserIsCompatible()) {
        map = new GMap2(document.getElementById("map"));
		map.addControl(new GSmallMapControl());
		map.addControl(new GMapTypeControl());
		map.enableScrollWheelZoom();
        map.setCenter(new GLatLng(-37.8133, 144.9594), 13);
        
				GEvent.addListener(map, "moveend", function() {
			var center = map.getCenter();
			document.getElementById("message").innerHTML = center.toString();
		});
				
		//						GEvent.addListener(map, "click", function() {
		//	alert('you clicked the map');
		//});
		
        geocoder = new GClientGeocoder();	
		
		// Create our car marker icon
		var icon = new GIcon();
		icon.image = "http://www.theveggiebox.org/marker-car.png";
		icon.shadow = "http://www.theveggiebox.org/marker-shadow.png";
		icon.iconSize = new GSize(26, 38);
		icon.shadowSize = new GSize(42, 37);
		icon.iconAnchor = new GPoint(13, 37);
		icon.infoWindowAnchor = new GPoint(13, 1);

		
		marker = new GMarker(new GLatLng(-37.76589748519094, 144.98367547988892), icon);
		GEvent.addListener(marker, "click", function() {
			marker.openInfoWindow(document.createTextNode("Hello, world"));
		});
		map.addOverlay(marker);

		
		
      }
    }
	
	function popWindow() {
			
			marker.openInfoWindow(document.createTextNode("you popped it!"));
			
	}

    function showAddress(address) {
      if (geocoder) {
        geocoder.getLatLng(
          address,
          function(point) {
            if (!point) {
              alert(address + " not found");
            } else {
              map.setCenter(point, 13);
              
			  var myMarkers = new Array()
			  myMarkers['marker2'] = new GMarker(point);
			  
			  // var marker2 = new GMarker(point);
			  
			  GEvent.addListener(myMarkers['marker2'], "click", function() {
							  myMarkers['marker2'].openInfoWindow(getElementById("firstdiv"));
			  });
			  
              map.addOverlay(myMarkers['marker2']);
              myMarkers['marker2'].openInfoWindowHtml(address);
			  
            }
          }
        );
      }
    }
	

	
	
	
    //]]>
    </script>
  </head>

  <body onload="load()" onunload="GUnload()">
    <form action="#" onsubmit="showAddress(this.address.value); return false">
      <p>
        <input type="text" size="60" name="address" value="175 Kent Street, Richmond, VIC, Australia" />
        <input type="submit" value="Go!" />
      </p>
    </form>
	
    <form action="#" onsubmit="popWindow(); return false">
      <p>
pop the window yeah! 
        <input type="submit" value="Go!" />
      </p>
    </form>	
	
	
      	<div>
	  		<div id="map" style="height: 500px; width:80%; margin:auto; border: solid black 1px;"></div>
		</div>
		<div id="message"></div>
		<div id="firstdiv"><p>some text</p></div>


  </body>
</html>


